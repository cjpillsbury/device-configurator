var e="spanning",n="single-fold-horizontal",t="single-fold-vertical",i="none",r="__foldables_env_vars__",o="(@media.*?\\b"+e+"\\b[^{]+)\\{([\\s\\S]+?\\})\\s*\\}",a=/\((.*?)\)/gi,s=/@media[^\(]+/gi,l=function(e){return new RegExp("env\\(\\s*"+e+"\\s*\\)","gi")};function d(e,n){return e.replace(new RegExp(o,"gi"),n)}function c(r){var l=function(e){var n,t=new RegExp(o,"gi");if("function"==typeof e.matchAll)n=Array.from(e.matchAll(t));else{for(n=[];n[n.length]=t.exec(e););n.length--}return n}(r),d={"single-fold-horizontal":"","single-fold-vertical":"",none:""};return l.forEach((function(r){var o=r[1],l=r[2],c=i;o.indexOf(n)>-1&&(c=n),o.indexOf(t)>-1&&(c=t);var f=o.match(s)||[],u=o.match(a)||[];u=u.filter((function(n){return!n.includes(e)})).join(" and "),d[c]+="\n      "+f+" "+u+" {\n        "+l+"\n      }"})),d}var f,u=function(){try{var e=function(){if(!v)return v=!0,Promise.resolve(Promise.resolve(!1)).then((function(e){v=e,f.dispatchEvent(new Event("change"))}))}();return Promise.resolve(e&&e.then?e.then((function(){})):void 0)}catch(e){return Promise.reject(e)}},h=window.matchMedia("(spanning: single-fold-horizontal)").matches||window.matchMedia("(spanning: single-fold-vertical)").matches||window.matchMedia("(spanning: none)").matches||!1;console.info("CSS Spanning Media Queries are supported? "+h);var g,v=!1,p=function(){var e=this;if(void 0!==f)return f;var n=document.createDocumentFragment();this.addEventListener=n.addEventListener.bind(n),this.removeEventListener=n.removeEventListener.bind(n),this.dispatchEvent=function(t){if("change"===t.type){var i="on"+t.type;return"function"==typeof e[i]&&e[i](t),n.dispatchEvent(t)}},window.addEventListener("message",(function(n){"update"===n.data.action&&Object.assign(e,n.data.value)}))},m={spanning:{configurable:!0},foldSize:{configurable:!0},browserShellSize:{configurable:!0}};if(m.spanning.get=function(){return sessionStorage.getItem(r+"-spanning")||i},m.spanning.set=function(e){sessionStorage.setItem(r+"-spanning",e),u()},m.foldSize.get=function(){return+sessionStorage.getItem(r+"-foldSize")||0},m.foldSize.set=function(e){sessionStorage.setItem(r+"-foldSize",e),u()},m.browserShellSize.get=function(){return+sessionStorage.getItem(r+"-browserShellSize")||0},m.browserShellSize.set=function(e){sessionStorage.setItem(r+"-browserShellSize",e),u()},Object.defineProperties(p.prototype,m),f=new p,console.log(f),!h){var S=Array.from(document.querySelectorAll('link[rel="stylesheet"], style'));(g=S,Promise.all(g.map((function(e){var n=e.href;return n?fetch(n).then((function(e){return e.text()})):e.textContent})))).then((function(e){if(h)return sheet;var n=new DocumentFragment;e.forEach((function(e,t){for(var i,r,o,a=d(e,""),s=c(e),l=S[t].href||"inline",f=0,u=Object.entries(s);f<u.length;f+=1){var h=u[f];w[h[0]]+="/* origin:  "+l+" */\n"+h[1]}n.appendChild((i={"data-css-origin":l},r=a,o=document.createElement("style"),Object.keys(i).forEach((function(e){o.setAttribute(e,i[e])})),void 0!==r&&(o.textContent=r),o))})),S.forEach((function(e){return null!=e.parentElement&&e.parentElement.removeChild(e)})),document.head.appendChild(n),E()}))}var w={};function b(e,r){var o;if(h)return e;var a=d(e,""),s=c(e);r&&(w[r]=((o={})[n]="",o[t]="",o[i]="",o));for(var l=r?w[r]:w,f=r||"inline",u=0,g=Object.entries(s);u<g.length;u+=1){var v=g[u];l[v[0]]+="/* origin:  "+f+" */\n"+v[1]}return l["non-spanning"]=a,a}function E(e){h||(y(e),window.addEventListener("resize",(function(){return n=y(e),function(){var e=arguments,i=this;clearTimeout(t),t=setTimeout((function(){return n.apply(i,e)}),150)};var n,t})),f.addEventListener("change",(function(){return y(e)})))}function y(e){for(var i,o,a,s,d,c,u,h=f,g=e?w[e.nodeName.toLowerCase()][h.spanning]:w[h.spanning],v=e?w[e.nodeName.toLowerCase()]["non-spanning"]:null,p=0,m=Object.entries((a=void 0,s=void 0,d=void 0,c=void 0,u=void 0,s=0,d=0,c=0,u=0,(o=h).spanning===t&&(c=o.foldSize,u=window.innerHeight,s=window.innerWidth/2-o.foldSize/2),o.spanning===n&&(c=window.innerWidth,u=o.foldSize,d=(window.innerHeight-o.browserShellSize)/2-o.foldSize/2),(a={})["fold-top"]=d,a["fold-left"]=s,a["fold-height"]=u,a["fold-width"]=c,a));p<m.length;p+=1){var S=m[p];i=S[1]+"px",g=g.replace(l(S[0]),i)}var b=function(e,n){for(var t=0,i=e.querySelectorAll("."+r);t<i.length;t+=1)i[t].remove();var o=document.createElement("style");o.className=r,o.textContent=n,e===document?document.head.appendChild(o):e.appendChild(o)};if(e){var E=e.shadowRoot;"adoptedStyleSheets"in E&&E.adoptedStyleSheets.length>0?E.adoptedStyleSheets[0].replace(v+g):b(E,g)}else b(document,g)}w[n]="",w[t]="",w[i]="";export{p as FoldablesFeature,b as adjustCSS,E as observe};
//# sourceMappingURL=spanning-css-polyfill.js.map
