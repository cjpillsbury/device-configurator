var e="spanning",n="single-fold-horizontal",t="single-fold-vertical",o="none",i="__foldables_env_vars__",r="(@media.*?\\b"+e+"\\b[^{]+)\\{([\\s\\S]+?\\})\\s*\\}",a=/\((.*?)\)/gi,d=/@media[^\(]+/gi;function l(e,n){return e.replace(new RegExp(r,"gi"),n)}function s(i){var l=function(e){var n,t=new RegExp(r,"gi");if("function"==typeof e.matchAll)n=Array.from(e.matchAll(t));else{for(n=[];n[n.length]=t.exec(e););n.length--}return n}(i),s={"single-fold-horizontal":"","single-fold-vertical":"",none:""};return l.forEach((function(i){var r=i[1],l=i[2],u=o;r.indexOf(n)>-1&&(u=n),r.indexOf(t)>-1&&(u=t);var c=r.match(d)||[],f=r.match(a)||[];f=f.filter((function(n){return!n.includes(e)})).join(" and "),s[u]+="\n      "+c+" "+f+" {\n        "+l+"\n      }"})),s}function u(e,n){var t;return function(){var o=arguments,i=this;clearTimeout(t),t=setTimeout((function(){return e.apply(i,o)}),n)}}if(void 0===window[i]){var c=sessionStorage.getItem(i+"-spanning")||o,f=+sessionStorage.getItem(i+"-foldSize")||0,h=+sessionStorage.getItem(i+"-browserShellSize")||0;Object.defineProperty(window,i,{value:{spanning:c,foldSize:f,browserShellSize:h,update:E,onupdate:[S]}}),window.addEventListener("message",(function(e){"update"===(e.data.action||"")&&window[i].update(e.data.value||{})}))}else window[i].onupdate.push(S);var p,w=Array.from(document.querySelectorAll('link[rel="stylesheet"], style')),g={};function m(e,i){var r,a=l(e,""),d=s(e);i&&(g[i]=((r={})[n]="",r[t]="",r[o]="",r));var u=i?g[i]:g;return Object.keys(d).forEach((function(e){void 0!==u[e]&&(u[e]+="\n        /* origin: "+(i||"inline")+" */\n        "+d[e])})),u["non-spanning"]=a,a}function v(e){S(e),window.addEventListener("resize",(function(){return u(S(e),150)})),window[i].onupdate.push((function(){return S(e)}))}function S(e){e?Array.from(e.shadowRoot.querySelectorAll("."+i)).forEach((function(e){return e.parentNode.removeChild(e)})):Array.from(document.querySelectorAll("."+i)).forEach((function(e){return e.parentElement.removeChild(e)}));var o=window[i],r=e?g[e.nodeName.toLowerCase()][o.spanning]:g[o.spanning],a=e?g[e.nodeName.toLowerCase()]["non-spanning"]:null,d=function(e){var o,i=0,r=0,a=0,d=0;return e.spanning===t&&(a=e.foldSize,d=window.innerHeight,i=window.innerWidth/2-e.foldSize/2),e.spanning===n&&(a=window.innerWidth,d=e.foldSize,r=(window.innerHeight-e.browserShellSize)/2-e.foldSize/2),(o={})["fold-top"]=r,o["fold-left"]=i,o["fold-height"]=d,o["fold-width"]=a,o}(o);Object.keys(d).forEach((function(e){var n;n=d[e]+"px",r=r.replace(function(e){return new RegExp("env\\(\\s*"+e+"\\s*\\)","gi")}(e),n)}));var l=document.createElement("style");if(l.className=i,l.textContent=r,e){var s=e.shadowRoot;"adoptedStyleSheets"in s&&s.adoptedStyleSheets.length>0?s.adoptedStyleSheets[0].replace(a+r):s.appendChild(l)}else document.head.appendChild(l)}g[n]="",g[t]="",g[o]="",(p=w,Promise.all(p.map((function(e){var n=e.href;return n?fetch(n).then((function(e){return e.text()})):e.textContent})))).then((function(e){var n=new DocumentFragment;e.forEach((function(e,t){var o,i,r,a=l(e,""),d=s(e),u=w[t].href||"inline";Object.keys(d).forEach((function(e){void 0!==g[e]&&(g[e]+="\n          /* origin:  "+u+" */\n          "+d[e])})),n.appendChild((o={"data-css-origin":u},i=a,r=document.createElement("style"),Object.keys(o).forEach((function(e){r.setAttribute(e,o[e])})),void 0!==i&&(r.textContent=i),r))})),w.forEach((function(e){return null!=e.parentElement&&e.parentElement.removeChild(e)})),document.head.appendChild(n),S(),window.addEventListener("resize",(function(){return u(S,150)}))}));var y=new Set(["foldSize","browserShellSize","spanning"]);function E(e){Object.keys(e).forEach((function(n){y.has(n)&&(window[i][n]=e[n],sessionStorage.setItem(i+"-"+n,window[i][n]))})),window[i].onupdate.forEach((function(e){return e()}))}export{m as adjustCSS,v as observe,E as update};
//# sourceMappingURL=spanning-css-polyfill.js.map
